# 1. 基本使用 - 随机初始化
from embedding_utils import get_embedding_layer

vocab_size = 10000
embedding_dim = 100

# 随机初始化嵌入层
embedding_random = get_embedding_layer(
    vocab_size=vocab_size,
    embedding_dim=embedding_dim,
    padding_idx=0
)

# 2. 使用预训练GloVe词向量
embedding_glove = get_embedding_layer(
    vocab_size=vocab_size,
    embedding_dim=100,
    padding_idx=0,
    glove_path='data/glove/glove.6B.100d.txt',
    vocab=vocab_dict,
    freeze_embedding=True  # 或 False 进行微调
)

# 3. 词汇分析
from embedding_utils import analyze_vocabulary

stats = analyze_vocabulary(
    texts=train_texts,
    vocab=vocab_dict,
    top_k=20
)
print(f"词汇表覆盖率: {stats['vocab_analysis']['coverage']:.2f}%")